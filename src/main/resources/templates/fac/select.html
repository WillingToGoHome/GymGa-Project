<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Title</title>
    <link rel="stylesheet" href="../styles/mainStyle.css">
    <link rel="stylesheet" href="../styles/headerStyle.css">
    <link rel="stylesheet" href="../styles/navbarStyle.css">
    <link rel="stylesheet" href="../styles/myStyle.css">
    <link rel="stylesheet" href="../styles/footerStyle.css">
    <link rel="stylesheet" href="../fac/facSelect.css">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
<!--        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap">-->
    <script src="fac/fac.js"></script>
</head>
<body>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>



<!--<div class="container">-->
<!--    <div class="app-area">-->
<!--        &lt;!&ndash;Heade Start&ndash;&gt;-->
<!--        <div th:include="common/header"></div>-->
<!--        &lt;!&ndash;Header End&ndash;&gt;-->

<!--        &lt;!&ndash;Main Start&ndash;&gt;-->
<!--        <div class="main-container">-->
<!--            &lt;!&ndash;Navbar Start&ndash;&gt;-->
<!--            <div th:include="common/navbar"></div>-->
<!--            &lt;!&ndash;Navbar End&ndash;&gt;-->
<!--            &lt;!&ndash;개인 작업 시작&ndash;&gt;-->
<!--            <div class="my-style">-->

<div class="container">
    <div th:each="facs: ${facList}" class="fac-item">
        <!-- Locker Code -->
        <span class="facCodeLink" th:text="${facs.facCode}" data-toggle="modal" data-target="#facActionModal"></span>
        <!-- Locker Status -->
        <span class="facStatus" th:text="${facs.facStatus}"></span>
        <!-- User Code -->
        <span class="userCode" th:text="${facs.userCode}"></span>
        <!-- Start Date -->
        <span class="facStart" th:text="${facs.facStart}"></span>
        <!-- End Date -->
        <span class="facEnd" th:text="${facs.facEnd}"></span>
    </div>
</div>

<!--<div class="container">-->
<!--    <ul class="fac-list">-->
<!--        <th:block th:each="facs: ${facList}">-->
<!--            <li class="fac-item">-->
<!--                &lt;!&ndash; Locker Code &ndash;&gt;-->
<!--                <span class="facCodeLink" th:text="${facs.facCode}" data-toggle="modal" data-target="#facActionModal"></span>-->
<!--                &lt;!&ndash; Locker Status &ndash;&gt;-->
<!--                <span class="facStatus" th:text="${facs.facStatus}"></span>-->
<!--                &lt;!&ndash; User Code &ndash;&gt;-->
<!--                <span class="userCode" th:text="${facs.userCode}"></span>-->
<!--                &lt;!&ndash; Start Date &ndash;&gt;-->
<!--                <span class="facStart" th:text="${facs.facStart}"></span>-->
<!--                &lt;!&ndash; End Date &ndash;&gt;-->
<!--                <span class="facEnd" th:text="${facs.facEnd}"></span>-->
<!--            </li>-->
<!--        </th:block>-->
<!--    </ul>-->
<!--</div>-->


<script th:inline="javascript">
    function setFacStatusColor() {
        document.querySelectorAll(".facStatus").forEach(function (element) {
            var selectedValue = element.textContent.trim();
            var color = "";
            if (selectedValue === "사용중") {
                color = "#4041C5";
            } else if (selectedValue === "만료") {
                color = "#F82626";
            } else {
                color = "black"; // 기본 색상
            }
            element.style.color = color;
        });
    }

    // 페이지 로드 시 호출하여 초기 색상 설정
    setFacStatusColor();

    // 클릭한 번호를 input 상자에 보여주는 함수
    $('.facCodeLink').click(function() {
        // 클릭한 번호 가져오기
        var facCode = $(this).text(); // 링크의 텍스트를 가져옴
        var userCode = $(this).siblings('.userCode').text(); // userCode를 가져오기 위해 형제 요소를 찾음

        // data-faccode 속성에 번호 설정
        $('#facActionModal').attr('data-facCode', facCode);
        // input 상자에 번호 표시
        $('#clickedFacCodeInput1').val(facCode);
        $('#clickedFacCodeInput2').val(facCode);
        $('#clickedFacCodeInput3').val(facCode);
        $('#clickedUserCodeInput').val(userCode);
        $('#facCode').val(facCode);
        $('#userCode3').val(userCode);
        $('.facActionModalFacCode4').val(userCode);


        // 변경된 데이터에 따라 스타일 다시 설정
        setFacStatusColor();
    });
</script>
<script>

    fetch("/fac/user")
        .then(res=>res.json())
        .then(data=> {
            const $userCode=document.getElementById("userCode");

            for(let index in data) {
                const $option=document.createElement('option');
                $option.text=data[index].userCode;
                $userCode.appendChild($option);
            }
        })

</script>


<div class="dropdown">
    <button class="dropbtn">조회</button>
    <div class="dropdown-content">
        <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#personalModal">개인조회</button>
        <a href="/fac/select/expired">만료조회</a>
    </div>
</div>

<!-- 개인 조회 모달 -->
<div class="modal fade" id="personalModal" tabindex="-1" role="dialog" aria-labelledby="personalModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="personalModalLabel">개인 조회</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <label>사물함 번호: </label>
                <select name="facCode" id="facCode"></select><br>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
                <button onclick="sendRequest()" class="btn btn-primary" data-dismiss="modal">확인</button>
            </div>
        </div>
    </div>
</div>



<!-- 사물함 등록, 수정, 삭제 모달 -->
<div class="modal fade" id="facActionModal" tabindex="-1" role="dialog" aria-labelledby="facActionModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="facActionModalLabel">사물함 등록, 수정 및 삭제</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- 등록, 수정, 삭제 버튼 -->
                <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#facActionModal2">등록</button>
                <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#facActionModal3">수정</button>
                <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#facActionModal4">삭제</button>


                <!--                <a class="btn btn-secondary" href="/fac/update">수정</a>-->
                <!--                <a class="btn btn-secondary" href="/fac/delete">삭제</a>-->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
            </div>
        </div>
    </div>
</div>
<!-- 사물함 등록 -->
<div class="modal fade" id="facActionModal2" tabindex="-1" role="dialog" aria-labelledby="facActionModalLabel2" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="facActionModalLabel2" >사물함 등록</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">
                <form id="registForm" onsubmit="submitForm()">
                    <label>사물함 번호: </label>
                    <input type="text" name="facCode" id="clickedFacCodeInput1" readonly><br>
<!--                    <label>회원 코드: </label>-->
<!--                    <input type="text" name="userCode" id="userCode"><br>-->
                    <label>회원 코드: </label>
                    <select name="userCode" id="userCode"></select><br>
                    <label>사용 가능 상태: </label>
                    <select name="facStatus" id="facStatus">
                        <option value=""></option>
                        <option value="사용중">사용 중</option>
                        <option value="만료">만료</option>
                    </select><br>
                    <label>사용 시작 기간: </label>
                    <input type="date" name="facStart" id="facStart"><br>
                    <label>사용 만료 기간: </label>
                    <input type="date" name="facEnd" id="facEnd"><br>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
                <button onclick="submitForm()" class="btn btn-primary" data-dismiss="modal">확인</button>
            </div>
        </div>
    </div>
</div>
<!-- 사물함 수정 -->
<div class="modal fade" id="facActionModal3" tabindex="-1" role="dialog" aria-labelledby="facActionModalLabel3" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="facActionModalLabel3">사물함 수정</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="updateForm" onsubmit="submitForm2()">
                    <label>사물함 번호: </label>
                    <input type="text" name="facCode" id="clickedFacCodeInput2" readonly><br>
                    <label>회원 코드: </label>
                    <input type="text" name="userCode" id="userCode3" ><br>
<!--                    <label>회원 코드: </label>-->
<!--                    <select name="userCode" id="userCode3"></select><br>-->
                    <label>사용 가능 상태: </label>
                    <select name="facStatus" id="facStatus3">
                        <option value=""></option>
                        <option value="사용중">사용 중</option>
                        <option value="만료">만료</option>
                    </select><br>
                    <label>사용 시작 기간: </label><input type="date" name="facStart"><br>
                    <label>사용 만료 기간: </label><input type="date" name="facEnd"><br>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
                <button onclick="submitForm2()" class="btn btn-primary" data-dismiss="modal">확인</button>
            </div>
        </div>
    </div>
</div>

<!-- 사물함 삭제 -->
<div class="modal fade" id="facActionModal4" tabindex="-1" role="dialog" aria-labelledby="facActionModalLabel4" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="facActionModalLabel4">사물함 삭제</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="deleteForm" onsubmit="submitForm3()">
                    <label>사물함 번호: </label>
                    <input type="text" name="facCode" id="clickedFacCodeInput3" readonly><br>
                    <label>사용 가능 상태: </label>
                    <select name="facStatus" id="facStatus4">
                        <option value=""></option>
                        <option value="사용중">사용 중</option>
                        <option value="만료">만료</option>
                    </select><br>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
                <button onclick="submitForm3()" class="btn btn-primary" data-dismiss="modal">확인</button>
            </div>
        </div>
    </div>
</div>



<!--            </div>-->
<!--            &lt;!&ndash;개인 작업 종료&ndash;&gt;-->
<!--        </div>-->
<!--        &lt;!&ndash;Main End&ndash;&gt;-->

<!--        &lt;!&ndash;Footer Start&ndash;&gt;-->
<!--        <div th:include="common/footer"></div>-->
<!--        &lt;!&ndash;Footer End&ndash;&gt;-->
<!--    </div>-->
<!--</div>-->

</body>
</html>